<?php

/**
 * @file
 * Provides moneris payment method for Drupal Commerce.
 */

define('COMMERCE_MONERIS_CANADA', 'ca');
define('COMMERCE_MONERIS_USA', 'us');

define('COMMERCE_MONERIS_PRODUCTION', 'prod');
define('COMMERCE_MONERIS_TEST', 'test');

/**
 * Implements hook_permission().
 */
function commerce_moneris_permission() {
  return array(
    'administer moneris' => array(
      'title' => t('Administer Moneris'),
      'description' => t('Perform administrative actions with Moneris.'),
    ),
  );
}

/**
 * Returns available Moneris environments.
 *
 * @param bool $translated
 *   A boolean indicating whether returned strings should be translated or not.
 *
 * @return array
 *   An array of available Moneris environments.
 */
function commerce_moneris_environments($translated = FALSE) {
  $environments = array(
    COMMERCE_MONERIS_TEST => 'Test',
    COMMERCE_MONERIS_PRODUCTION => 'Production',
  );

  if ($translated) {
    $environments = array_map('t', $environments);
  }

  return $environments;
}

/**
 * Returns available Moneris gateways (countries).
 *
 * @param bool $translated
 *   A boolean indicating whether returned strings should be translated or not.
 *
 * @return array
 *   An array of available Moneris gateways (countries).
 */
function commerce_moneris_gateways($translated = FALSE) {
  $gateways = array(
    COMMERCE_MONERIS_CANADA => t('Canada'),
    COMMERCE_MONERIS_USA => t('US'),
  );

  if ($translated) {
    $gateways = array_map('t', $gateways);
  }

  return $gateways;
}

/**
 * Returns supported transaction types for a specified gateway (country).
 *
 * @param string $gateway_id
 *   A gateway ID indicating which country to return transaction types for.
 * @param bool $translated
 *   A boolean indicating whether returned strings should be translated or not.
 *
 * @return array
 *   An array of available transaction types for a specified gateway (country).
 */
function commerce_moneris_transaction_types($gateway_id, $translated = FALSE) {
  $transaction_types = array(
    'ca' => array(
      'purchase' => t('Purchase'),
      'preauth' => t('PreAuth'),
    ),
    'us' => array(
      'us_purchase' => t('Purchase'),
      'us_preauth' => t('PreAuth'),
    ),
  );

  if ($translated) {
    $transaction_types[$gateway_id] = array_map('t', $transaction_types[$gateway_id]);
  }

  return $transaction_types[$gateway_id];
}
